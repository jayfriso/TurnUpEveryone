<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>EveryoneTurnUp</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <script type='text/javascript' src='../js/knockout-3.4.0.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>

    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container main-container">
    
      <div class="main-player-row row">
          <div class="main-player jumbotron">
              <p class="currently-playing"> <i>Currently Playing...</i></p>
              <h1 class="song-title"> Highway TO Hell</h1> 
              <p class="artists"> by ACDC</p>
          </div>
      </div>

      <div class="song-queue-row table-responsive row">
          <table class="song-queue-table table">
            <tbody data-bind="foreach: playlist">         <!--data-bind here for iteration through the arraylist-->
              <tr class="song-row">

              <div class="song-info col-sm-10">
                  <td class="queue-number"> 
                    <h1> 1 </h1> 
                  </td>
                  <td class="song-info">
                    <h1 data-bind="text: name" class = "song-title"> Song 1</h1>
                    <p data-bind="text: artist" class="artist"> by Artist 1</p>
                  </td>
              </div>
              <!--<div id="counting">0</div>!-->
                  <td class="vote-cell col-sm-2">
                  	<p data-bind="text: vote" class="num-votes" id="counting"> 0</p>      <!--data-bind here for displaying votes-->
               		<button class="vote" id="btn" data-bind="click: function(data, event) { add(data, event, $index()); }">Vote</button>
                  </td>
              
              </tr>            

            </tbody>
          </table>
      </div>


  <script type="text/javascript">
/*    var x = new Firebase('https://countingex.firebaseio-demo.com/');

	x.on('value', function f(s) {
	    $('.num-votes').text(0 + s.val());
	});

	$('.vote').click(function() {
	  x.transaction(function(current_value) {
	    return current_value + 1;
	  });
	});

	$('.reset').click(function() {
	    x.set(0);
	});*/


var x = new Firebase('https://partycounter.firebaseio.com/');

x.on('value', function f(s) {
x.transaction(function(current_value) {
    $('#counting').text(current_value[0].counter);})
});

/*
$('#btn').click(function() {
  x.transaction(function(current_value) {
  console.log(current_value[0]);
  
    if(!current_value) {
      current_value=[
      {counter:0},
      {counter:0},
      {counter:0},
      {counter:0},
      {counter:0}
      ];
    } 
    current_value[0].counter++;
    return current_value;
  });
});
*/
function Song(name, artist) {

    this.name = name;
    this.artist = artist;
    this.vote = ko.observable(0);
    this.isBeingPlayed = false;

    this.add = function(data, event, index) {
      console.log(index);
/*
      x.transaction(function(current_value) {
  console.log(current_value[0]);

  
    current_value[index].counter++;
    return current_value[index];
  });
*/
   }; 
}

function SongsViewModel() {
    var self = this;
  
    // Editable data
    self.playlist = ko.observableArray([
        new Song("Song 1", "Artist 1"),
        new Song("Song 2", "Artist 2"),
        new Song("Song 3", "Artist 3"),
        new Song("Song 4", "Artist 4"),
        new Song("Song 5", "Artist 5"),
    ]);
}

ko.applyBindings(new SongsViewModel());

  </script>

  </body>
</html>